SHELL=/bin/sh

OS		= @OS@
SUFFIX		= @SUFFIX@
HOSTNAME	= @ac_hostname@
B2H_HOME	= @B2H_HOME@
B2H_DIR_INCLUDE= $(B2H_HOME)/src
B2H_DIR_LIB	= $(B2H_HOME)/lib
B2H_DIR_OBJ	= $(B2H_HOME)/.obj
B2H_LIB_PATH	= $(B2H_DIR_LIB)
B2H_OBJ_PATH	= $(B2H_DIR_OBJ)/$(HOSTNAME)$(SUFFIX)
B2H_DEP_PATH	= $(B2H_DIR_DEP)/$(HOSTNAME)$(SUFFIX)

LIB		= $(B2H_LIB_PATH)/lib@B2H_LIBNAME@.a

.DELETE_ON_ERROR:

all install : src FORCE
	cd src; $(MAKE) $@

example: FORCE
	cd example; $(MAKE)


src: directory FORCE
	cd src; $(MAKE) install


directory:
	@if [ ! -d bin ] ;\
	then \
		echo "*" ; \
		echo "* Creation of the bin directory..." ; \
		echo "*" ; \
		mkdir bin ; \
	fi ;
	@if [ ! -d lib ] ;\
	then \
		echo "*" ; \
		echo "* Creation of the lib directory..." ; \
		echo "*" ; \
		mkdir lib ; \
	fi ;

clean:
	rm -f *% */*%
	rm -f *~ */*~
	cd src; $(MAKE) $@
	cd example; $(MAKE) $@

uninstall:
	rm -f .buildoutput .buildpath
	rm -f $(B2H_OBJ_PATH)/*.o
	rm -f $(B2H_LIB_PATH)/lib@B2H_LIBNAME@.a
	cd example ; $(MAKE) uninstall
	@for i in `find . -type f -name Makefile.in -print | sort` ; do\
		filetoremove=`echo "$$i" | sed -e "s;Makefile.in;Makefile;g"`;\
		rm -f $${filetoremove};\
		echo "rm -f " $${filetoremove};\
	done
	@for i in `find . -type f -name build.mk.in -print | sort` ; do\
		filetoremove=`echo "$$i" | sed -e "s;build.mk.in;build.mk;g"`;\
		rm -f $${filetoremove};\
		echo "rm -f " $${filetoremove};\
	done


uninstallall:
	$(MAKE) clean;
	$(MAKE) uninstall;
	rm -f config.log config.status
	rm -rf $(B2H_DIR_OBJ)
	rm -rf autom4te.cache
	@for i in `find . -type f -name .inslog2 -print | sort` ; do\
		rm -f $$i;\
		echo "rm -f " $$i;\
	done
	@for i in `find . -type f -name .depend -print | sort` ; do\
		rm -f $$i;\
		echo "rm -f " $$i;\
	done
	@for i in `find . -type f -name tca.* -print | sort` ; do\
		rm -f $$i;\
		echo "rm -f " $$i;\
	done
	@for i in `find . -type d -name pchdir -print | sort` ; do\
		rm -fr $$i;\
		echo "rm -fr " $$i;\
	done



FORCE:
